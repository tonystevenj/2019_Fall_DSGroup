<template>
  <div ref="crime" class="wbg" style="width: 100%; height: 400px;"></div>
</template>

<script>
import echarts from "echarts";

export default {
  name: "Crime",
  props: {
    zipcode: {
      type: Number,
      required: true
    }
  },
  components: {},
  data() {
    return {
      chart: null
    };
  },
  mounted() {
    this.chart = echarts.init(this.$refs.crime, "light");
    this.draw([]);
    this.request();
  },
  methods: {
    request() {
      let data = {"RAPE": {"1448841600000": 3, "1451520000000": 5, "1454198400000": 7, "1456704000000": 3, "1459382400000": 3, "1461974400000": 1, "1464652800000": 2, "1467244800000": 3, "1469923200000": 1, "1472601600000": 6, "1475193600000": 2, "1477872000000": 6, "1480464000000": 3, "1483142400000": 2, "1485820800000": 3, "1488240000000": 1, "1490918400000": 3, "1493510400000": 5, "1496188800000": 3, "1498780800000": 7, "1501459200000": 3, "1504137600000": 2, "1506729600000": 9, "1509408000000": 4, "1512000000000": 3, "1514678400000": 1, "1517356800000": 4, "1519776000000": 1, "1522454400000": 6, "1525046400000": 5, "1527724800000": 3, "1530316800000": 3, "1532995200000": 2, "1535673600000": 3, "1538265600000": 4, "1540944000000": 1, "1543536000000": 3, "1546214400000": 4, "1548892800000": 4, "1551312000000": 5, "1553990400000": 5, "1556582400000": 7, "1559260800000": 1, "1561852800000": 5, "1564531200000": 7, "1567209600000": 1, "1569801600000": 3, "1572480000000": 5}, "LARCENY-THEFT": {"1448841600000": 33, "1451520000000": 42, "1454198400000": 50, "1456704000000": 48, "1459382400000": 35, "1461974400000": 37, "1464652800000": 39, "1467244800000": 47, "1469923200000": 44, "1472601600000": 55, "1475193600000": 34, "1477872000000": 52, "1480464000000": 57, "1483142400000": 60, "1485820800000": 51, "1488240000000": 64, "1490918400000": 58, "1493510400000": 47, "1496188800000": 53, "1498780800000": 68, "1501459200000": 51, "1504137600000": 41, "1506729600000": 58, "1509408000000": 51, "1512000000000": 51, "1514678400000": 48, "1517356800000": 53, "1519776000000": 47, "1522454400000": 38, "1525046400000": 39, "1527724800000": 54, "1530316800000": 46, "1532995200000": 44, "1535673600000": 59, "1538265600000": 50, "1540944000000": 59, "1543536000000": 53, "1546214400000": 62, "1548892800000": 58, "1551312000000": 46, "1553990400000": 36, "1556582400000": 57, "1559260800000": 44, "1561852800000": 63, "1564531200000": 48, "1567209600000": 44, "1569801600000": 51, "1572480000000": 54}, "MOTOR VEHICLE THEFT": {"1448841600000": 12, "1451520000000": 4, "1454198400000": 11, "1456704000000": 16, "1459382400000": 13, "1461974400000": 13, "1464652800000": 9, "1467244800000": 11, "1469923200000": 10, "1472601600000": 18, "1475193600000": 18, "1477872000000": 7, "1480464000000": 14, "1483142400000": 12, "1485820800000": 12, "1488240000000": 13, "1490918400000": 17, "1493510400000": 9, "1496188800000": 2, "1498780800000": 11, "1501459200000": 7, "1504137600000": 19, "1506729600000": 11, "1509408000000": 15, "1512000000000": 14, "1514678400000": 5, "1517356800000": 13, "1519776000000": 12, "1522454400000": 7, "1525046400000": 7, "1527724800000": 16, "1530316800000": 8, "1532995200000": 12, "1535673600000": 8, "1538265600000": 13, "1540944000000": 12, "1543536000000": 7, "1546214400000": 8, "1548892800000": 7, "1551312000000": 4, "1553990400000": 9, "1556582400000": 12, "1559260800000": 9, "1561852800000": 13, "1564531200000": 14, "1567209600000": 12, "1569801600000": 8, "1572480000000": 16}, "BURGLARY": {"1448841600000": 17, "1451520000000": 23, "1454198400000": 21, "1456704000000": 18, "1459382400000": 24, "1461974400000": 11, "1464652800000": 18, "1467244800000": 22, "1469923200000": 11, "1472601600000": 19, "1475193600000": 13, "1477872000000": 17, "1480464000000": 16, "1483142400000": 16, "1485820800000": 18, "1488240000000": 20, "1490918400000": 24, "1493510400000": 27, "1496188800000": 23, "1498780800000": 19, "1501459200000": 18, "1504137600000": 17, "1506729600000": 20, "1509408000000": 24, "1512000000000": 17, "1514678400000": 18, "1517356800000": 18, "1519776000000": 16, "1522454400000": 15, "1525046400000": 17, "1527724800000": 15, "1530316800000": 21, "1532995200000": 20, "1535673600000": 25, "1538265600000": 12, "1540944000000": 28, "1543536000000": 29, "1546214400000": 28, "1548892800000": 16, "1551312000000": 15, "1553990400000": 10, "1556582400000": 11, "1559260800000": 26, "1561852800000": 22, "1564531200000": 22, "1567209600000": 20, "1569801600000": 17, "1572480000000": 26}, "AGGRAVATED ASSAULT": {"1448841600000": 6, "1451520000000": 10, "1454198400000": 10, "1456704000000": 14, "1459382400000": 18, "1461974400000": 8, "1464652800000": 9, "1467244800000": 15, "1469923200000": 5, "1472601600000": 11, "1475193600000": 10, "1477872000000": 7, "1480464000000": 8, "1483142400000": 11, "1485820800000": 9, "1488240000000": 6, "1490918400000": 11, "1493510400000": 14, "1496188800000": 11, "1498780800000": 8, "1501459200000": 8, "1504137600000": 8, "1506729600000": 9, "1509408000000": 16, "1512000000000": 10, "1514678400000": 12, "1517356800000": 10, "1519776000000": 18, "1522454400000": 15, "1525046400000": 12, "1527724800000": 6, "1530316800000": 13, "1532995200000": 14, "1535673600000": 11, "1538265600000": 21, "1540944000000": 15, "1543536000000": 17, "1546214400000": 10, "1548892800000": 14, "1551312000000": 11, "1553990400000": 11, "1556582400000": 15, "1559260800000": 11, "1561852800000": 12, "1564531200000": 15, "1567209600000": 11, "1569801600000": 5, "1572480000000": 18}, "ROBBERY": {"1448841600000": 1, "1451520000000": 5, "1454198400000": 5, "1456704000000": 2, "1459382400000": 6, "1461974400000": 8, "1464652800000": 9, "1467244800000": 5, "1469923200000": 3, "1472601600000": 11, "1475193600000": 8, "1477872000000": 4, "1480464000000": 9, "1483142400000": 8, "1485820800000": 4, "1488240000000": 2, "1490918400000": 3, "1493510400000": 3, "1496188800000": 4, "1498780800000": 12, "1501459200000": 7, "1504137600000": 5, "1506729600000": 11, "1509408000000": 12, "1512000000000": 5, "1514678400000": 6, "1517356800000": 5, "1519776000000": 11, "1522454400000": 1, "1525046400000": 4, "1527724800000": 6, "1530316800000": 3, "1532995200000": 2, "1535673600000": 8, "1538265600000": 2, "1540944000000": 7, "1543536000000": 2, "1546214400000": 7, "1548892800000": 7, "1551312000000": 8, "1553990400000": 3, "1556582400000": 4, "1559260800000": 12, "1561852800000": 6, "1564531200000": 8, "1567209600000": 4, "1569801600000": 3, "1572480000000": 9}, "DRUG OFFENSE": {"1448841600000": 3, "1451520000000": 6, "1454198400000": 8, "1456704000000": 7, "1459382400000": 9, "1461974400000": 6, "1464652800000": 7, "1467244800000": 4, "1469923200000": 3, "1472601600000": 7, "1475193600000": 7, "1477872000000": 2, "1480464000000": 12, "1483142400000": 6, "1485820800000": 10, "1488240000000": 6, "1490918400000": 10, "1493510400000": 11, "1496188800000": 9, "1498780800000": 5, "1501459200000": 11, "1504137600000": 11, "1506729600000": 8, "1509408000000": 6, "1512000000000": 8, "1514678400000": 6, "1517356800000": 17, "1519776000000": 13, "1522454400000": 13, "1525046400000": 7, "1527724800000": 10, "1530316800000": 3, "1532995200000": 10, "1535673600000": 11, "1538265600000": 12, "1540944000000": 16, "1543536000000": 20, "1546214400000": 20, "1548892800000": 10, "1551312000000": 11, "1553990400000": 16, "1556582400000": 22, "1559260800000": 13, "1561852800000": 21, "1564531200000": 8, "1567209600000": 22, "1569801600000": 14, "1572480000000": 13}, "ARSON": {"1448841600000": 2, "1451520000000": 0, "1454198400000": 0, "1456704000000": 0, "1459382400000": 1, "1461974400000": 0, "1464652800000": 0, "1467244800000": 0, "1469923200000": 0, "1472601600000": 0, "1475193600000": 3, "1477872000000": 0, "1480464000000": 0, "1483142400000": 0, "1485820800000": 1, "1488240000000": 0, "1490918400000": 2, "1493510400000": 1, "1496188800000": 2, "1498780800000": 2, "1501459200000": 0, "1504137600000": 1, "1506729600000": 2, "1509408000000": 0, "1512000000000": 4, "1514678400000": 1, "1517356800000": 5, "1519776000000": 0, "1522454400000": 2, "1525046400000": 0, "1527724800000": 0, "1530316800000": 1, "1532995200000": 1, "1535673600000": 1, "1538265600000": 1, "1540944000000": 0, "1543536000000": 0, "1546214400000": 3, "1548892800000": 0, "1551312000000": 1, "1553990400000": 0, "1556582400000": 5, "1559260800000": 3, "1561852800000": 2, "1564531200000": 0, "1567209600000": 4, "1569801600000": 1}, "MURDER AND NON-NEGLIGENT MANSLAUGHTER": {"1451520000000": 2, "1454198400000": 0, "1456704000000": 1, "1459382400000": 1, "1461974400000": 0, "1464652800000": 0, "1467244800000": 1, "1469923200000": 0, "1472601600000": 0, "1475193600000": 0, "1477872000000": 1, "1480464000000": 3, "1483142400000": 0, "1485820800000": 0, "1488240000000": 1, "1490918400000": 0, "1493510400000": 0, "1496188800000": 0, "1498780800000": 1, "1501459200000": 0, "1504137600000": 1, "1506729600000": 0, "1509408000000": 0, "1512000000000": 0, "1514678400000": 1, "1517356800000": 0, "1519776000000": 1, "1522454400000": 0, "1525046400000": 0, "1527724800000": 1, "1530316800000": 0, "1532995200000": 0, "1535673600000": 0, "1538265600000": 0, "1540944000000": 1, "1543536000000": 0, "1546214400000": 0, "1548892800000": 1, "1551312000000": 1, "1553990400000": 0, "1556582400000": 1, "1559260800000": 0, "1561852800000": 0, "1564531200000": 0, "1567209600000": 1}};
      this.draw(data);
      // this.axios
      //   .get("/api/report/crime", {
      //     params: {
      //       zipcode: this.zipcode
      //     }
      //   })
      //   .then(response => {
      //     this.draw(response.data);
      //   })
      //   .catch(response => {
      //     console.log(response);
      //   });
    },
    draw(data) {
      let legendData = [];
      let xAxisData = [];
      let seriesData = [];
      let maxValue = 0;
      if (data.length == 0) {
        xAxisData = {
          data: [],
          type: "time",
          splitLine: {
            show: false
          }
        };
      }
      for (let i in data) {
        legendData.push(i);
        let xAxisTmp = [];
        let seriesTmp = [];
        for (let j in data[i]) {
          if (data[i][j] > maxValue) {
            maxValue = data[i][j];
          }
          var itemDate = new Date(j - 1);
          xAxisTmp.push(itemDate.getMonth() + 1 + "/" + itemDate.getFullYear());
          seriesTmp.push({
            name: itemDate.toString(),
            value: [
              [
                itemDate.getFullYear(),
                itemDate.getMonth() + 1,
                itemDate.getDate()
              ].join("/"),
              data[i][j]
            ]
          });
        }
        xAxisData.push({
          data: xAxisTmp,
          type: "time",
          splitLine: {
            show: false
          }
        });
        seriesData.push({
          name: i,
          type: "line",
          data: seriesTmp,
          areaStyle: { normal: {} }
        });
      }
      let option = {
        title: {
          text: "Crime",
          textAlign: "auto"
        },
        tooltip: {
          trigger: "axis",
          axisPointer: {
            type: "cross",
            label: {
              backgroundColor: "#6a7985"
            }
          }
        },
        grid: {
          top: 50,
          bottom: 70,
          left: 50,
          right: 50,
        },
        legend: {
          type: "scroll",
          data: legendData,
          left: 30,
          right: 30,
          bottom: 10
        },
        xAxis: xAxisData,
        yAxis: {
          type: "value",
          boundaryGap: [0, "100%"],
          splitLine: {
            show: false
          },
          max: maxValue + 10
        },
        series: seriesData
      };
      this.chart.setOption(option);
    }
  }
};
</script>